@charset "UTF-8";

/*
Lobsters doesn't use CSS features until the "Widely available" Baseline standard:
https://web-platform-dx.github.io/web-features/

But I make an unprincipled exception for :has because it solves so many big problems.
*/

:root {
	/* Assurify Dark Theme - Black background, white text, blue links, red accents */
	
	/* Base colors */
	--base-bg: 0 0 0; /* Black background */
	--base-fg: 255 255 255; /* White text */
	
	/* Opacity levels for contrast */
	--opacity-fg: 1.0;
	--opacity-fg-contrast-13: 0.87;
	--opacity-fg-contrast-10: 0.75;
	--opacity-fg-contrast-7-5: 0.6;
	--opacity-fg-contrast-6: 0.5;
	--opacity-fg-contrast-5: 0.4;
	--opacity-fg-contrast-4-5: 0.35;
	--opacity-gradient-lit: 0.9;
	--opacity-gradient-shadowed: 0.7;
	--opacity-shadow-80: 0.8;
	--opacity-shadow-25: 0.25;
	--opacity-shadow-10: 0.1;
	
	/* Applied color scheme */
	--color-bg: rgb(var(--base-bg));
	--color-bg-50: rgb(var(--base-bg) / 50%);

	--color-fg: rgb(var(--base-fg) / var(--opacity-fg)); /* primary text */
	--color-fg-contrast-13: rgb(var(--base-fg) / var(--opacity-fg-contrast-13));
	--color-fg-contrast-10: rgb(var(--base-fg) / var(--opacity-fg-contrast-10));
	--color-fg-contrast-7-5: rgb(var(--base-fg) / var(--opacity-fg-contrast-7-5));
	--color-fg-contrast-6: rgb(var(--base-fg) / var(--opacity-fg-contrast-6));
	--color-fg-contrast-5: rgb(var(--base-fg) / var(--opacity-fg-contrast-5));
	--color-fg-contrast-4-5: rgb(var(--base-fg) / var(--opacity-fg-contrast-4-5));

	--color-fg-gradient-lit: rgb(var(--base-fg) / var(--opacity-gradient-lit));
	--color-fg-gradient-shadowed: rgb(var(--base-fg) / var(--opacity-gradient-shadowed));

	/* Links - Blue theme */
	--color-fg-link: #4a9eff; /* Bright blue for links */
	--color-fg-link-visited: #b19cd9; /* Purple for visited links */
	--color-fg-link-hover: #6bb6ff; /* Lighter blue on hover */

	/* Red accent colors */
	--color-accent: #ff4444; /* Bright red for accents */
	--color-accent-hover: #ff6666; /* Lighter red on hover */
	--color-accent-dark: #cc3333; /* Darker red for borders */

	/* Tag colors */
	--color-tag-bg: #333333;
	--color-tag-border: #555555;
	--color-tag-media-bg: #2c2c54;
	--color-tag-media-border: #40407a;

	/* Utility colors */
	--base-light: 255 255 255;
	--color-light-25: rgb(var(--base-light) / 25%);

	--base-shadow: 255 255 255; /* White shadows on dark background */
	--color-shadow: rgb(var(--base-shadow));
	--color-shadow-80: rgb(var(--base-shadow) / var(--opacity-shadow-80));
	--color-shadow-25: rgb(var(--base-shadow) / var(--opacity-shadow-25));
	--color-shadow-10: rgb(var(--base-shadow) / var(--opacity-shadow-10));
}

/* generics */

html {
	/* force a vertical scrollbar to avoid page-shifting */
	overflow-y: scroll;

	/* avoid automatic resizing of some text elements on phones in landscape */
	-moz-text-size-adjust: none;
	-webkit-text-size-adjust: none;
	text-size-adjust: none;
}

body, textarea, input, button {
	font-family: "helvetica neue", arial, sans-serif;
	font-size: 10pt;
	color: var(--color-fg);
	line-height: 1.45em;
}

body {
	background-color: var(--color-bg);
	margin: 0 auto;
	padding-bottom: 2em;
}

a {
	color: var(--color-fg-link);
	cursor: pointer;
	text-decoration: none;
}

a:hover {
	color: var(--color-fg-link-hover);
	text-decoration: underline;
}

li.story div.details span.link a:visited {
	color: var(--color-fg-link-visited);
}

h1 {
	font-size: 12pt;
	font-weight: bold;
	margin: 0.5em 0 1em 0;
	padding: 0;
}
h2 {
	font-size: 11pt;
}

.clear {
	clear: both;
}

a.tag {
	background-color: var(--color-tag-bg);
	border: 1px solid var(--color-tag-border);
	border-radius: 5px;
	color: var(--color-fg-contrast-10);
	font-size: 8pt;
	margin-left: 0.25em;
	padding: 0px 0.4em 1px 0.4em;
	text-decoration: none;
	white-space: nowrap;
}
a.tag_is_media {
	background-color: var(--color-tag-media-bg);
	border-color: var(--color-tag-media-border);
	color: var(--color-fg-contrast-10);
}
a.tag_meta {
	background-color: var(--color-tag-meta-bg);
	border-color: var(--color-tag-meta-border);
}
a.tag_announce, a.tag_ask, a.tag_show, a.tag_interview {
	background-color: var(--color-lobsters-tag-special-bg);
	border-color: var(--color-lobsters-tag-special-border);
	color: var(--color-fg-contrast-10);
}

.hat {
	width: min-content;
	border-bottom: 6px solid var(--color-hat-brim-stroke);
	border-radius: 0px 0px 4px 4px;
	padding: 1px 8px;
	vertical-align: super;
	white-space: nowrap;
}
.hat .crown {
	background-color: var(--color-hat-crown-fill);
	border: 1px solid var(--color-hat-crown-stroke);
	border-bottom: 0;
	border-radius: 5px 5px 0px 0px;
	font-size: 8pt;
	padding: 3px 5px 2px 5px;
	text-decoration: none;
	vertical-align: text-top;
}

.hat .crown, .hat a {
	color: var(--color-fg-contrast-6);
	text-decoration: none;
}
.hat_openbsd_developer .crown {
	font-family: comic sans ms, comic sans, comic neue, sans-serif;
	font-size: 7pt;
}
.hat_sysop {
	border-color: var(--color-lobsters-hat-sysop-brim-stroke);
	color: var(--color-fg-contrast-10);
}
.hat_sysop .crown {
	background-color: var(--color-lobsters-hat-sysop-crown-fill);
}

span.na {
	color: var(--color-fg-contrast-5);
	font-style: italic;
}

div.shorten_first_p p:first-child {
	margin-top: 0;
}

hr {
	/* make it lighter than the browser's default */
	border: none;
	height: 1px;
	background-color: var(--color-fg-shape);
}
pre {
	overflow-x: auto;
}

/* default form styling */

input,
button,
select,
textarea {
	color: var(--color-fg-contrast-10);
	background-color: var(--color-box-bg);
	padding: 3px 5px;
}
textarea {
	resize: vertical;
}
input[type="text"],
input[type="search"],
input[type="password"],
input[type="email"],
input[type="number"],
input[type="url"],
textarea {
	border: 1px solid var(--color-box-border);
}
input:focus, textarea:focus {
	outline-style: solid;
	outline-width: 2px;
}
input[type="checkbox"] {
	margin-top: 0.5em;
}
select {
	border: 1px solid var(--color-box-border);
}
input:focus,
textarea:focus {
	border-color: var(--color-box-border-focus);
	color: var(--color-fg);
	outline: 0;
}
textarea::placeholder {
	color: var(--color-fg-contrast-7-5);
}
.link_post {
	display: inline;
}
input[type="submit"].link_post {
	background: none;
	border: none;
	color: var(--color-fg-link);
	cursor: pointer;
	outline: none;
	padding: 0;
	text-decoration: underline;
}
.byline input[type="submit"].link_post {
	color: var(--color-fg-contrast-4-5);
	text-decoration: none;
}

input[type="submit"]:focus,
button:focus {
	border-color: var(--color-box-border-focus);
	outline: 1px solid var(--color-box-border-focus);
}

/* these must be separate */
::-webkit-input-placeholder {
	color: var(--color-fg-contrast-5);
	font-style: italic;
}
:-moz-placeholder {
	color: var(--color-fg-contrast-5);
	font-style: italic;
}

button,
input[type="button"],
input[type="reset"],
input[type="submit"],
a.button {
	background-color: var(--color-button-bg);
	border-bottom-color: var(--color-fg-shape);
	border: 1px solid var(--color-box-border);
	color: var(--color-fg);
	cursor: pointer;
	display: inline-block;
	line-height: 18px;
	padding: 2px 10px 2px 10px;
	text-align: center;
	text-decoration: none;
}
button:first-child,
input[type="button"]:first-child,
input[type="reset"]:first-child,
input[type="submit"]:first-child {
	margin-left: 0;
}
button:hover,
input[type="button"]:hover,
input[type="reset"]:hover,
input[type="submit"]:hover {
	color: var(--color-fg-contrast-10);
	text-decoration: none;
	background-color: var(--color-button-bg-shaded);
}

select {
	margin-top: 3px;
	min-width: 100px;
}
select:focus {
	border-color: var(--color-box-border-focus);
	color: var(--color-fg);
	outline: 0;
}
select::-moz-focus-inner {
	border: 0;
	outline: 0;
}

input:disabled,
textarea:disabled,
button:disabled {
	background-color: var(--color-box-bg-shaded);
	color: var(--color-fg-contrast-5);
}

a.button,
button.deletion,
input.deletion {
	color: var(--color-fg-negative);
	border: 1px solid var(--color-fg-negative);
}

summary {
	cursor: pointer;
}

#qrsvg {
	background-color: white;
	display: inline-block;
	padding: 5%;
}

.totp_code::-webkit-inner-spin-button,
.totp_code::-webkit-outer-spin-button {
	-webkit-appearance: none;
	margin: 0;
}


/* header */

header {
	font-weight: bold;
	line-height: 18px;
	padding-top: 15px;
}

#logo {
	background: transparent url(logo-transparent.svg) no-repeat center;
	flex: 0 0 16px; /* width; no padding l/r */
	float: left;
	display: block;
	width: 16px;
	height: 16px;
	padding: 1px;
	margin-left: 4px;
	margin-right: 11px;
	position: relative;
}

/* Text-based Assurify logo */
.logo {
	text-decoration: none !important;
	color: inherit;
	display: inline-block;
}

.logo-text {
	font-size: 28px;
	font-weight: bold;
	color: var(--color-accent);
	font-family: "Arial Black", "Helvetica Neue", Arial, sans-serif;
	letter-spacing: -1px;
	text-decoration: none;
	transition: color 0.2s ease;
}

.logo:hover .logo-text {
	color: var(--color-accent-hover);
}

/* Responsive logo sizing */
@media (max-width: 768px) {
	.logo-text {
		font-size: 24px;
	}
}

@media (max-width: 480px) {
	.logo-text {
		font-size: 20px;
	}
}

header#nav .navholder {
	display: flex;
	flex-wrap: nowrap;
	overflow-x: auto;
	overflow-y: clip;
	position: relative; /* context for nav gradients */
	width: 100%;
}
header#nav {
	box-sizing: border-box;
	display: flex;
	padding: 0.5rem 0.5rem 0 0.5rem;
}
header#nav nav.links {
	display: flex;
	width: 100%
}
header#nav a, header#subnav a, header#subnav input[type="submit"] {
	color: var(--color-fg-contrast-6);
	font-weight: bold;
	margin: 0 0.25rem;
	text-decoration: none;
}
header#subnav {
	box-sizing: border-box;
	min-height: 2em;
	line-height: 1em;
	padding: 0.5rem 0.25rem;
	text-align: right;
	width: 100%;
}
header#subnav a.current_page:last-child {
	margin-right: 0.375rem;
}
header a.current_page {
	border-bottom: 0.25em solid var(--color-accent);
	padding: 0 0.25rem 0.25rem;
}
header#nav #logo {
	margin-left: 0;
	margin-right: 4rem; /* Increase space to prevent overlap with logo text */
}
header#nav #logo ~ a {
	margin-left: 0;
}
header#nav a:last-child {
	margin-right: 0;
}
header .inbox_unread {
	color: var(--color-accent);
}

#inside {
	margin: 0.5rem 0;
}

/* footer */

footer {
	box-sizing: border-box;
	display: flex;
	padding: 2em 0.5em;
	justify-content: space-between;
	width: 100%;
}
footer a {
	color: var(--color-fg-contrast-4-5);
}
footer nav a {
	padding-left: 0.75em;
	text-decoration: none;
}


/* other specifics */
div#gravatar {
	border: 2px solid var(--color-box-bg);
	border-radius: 100% 100%;
	box-shadow: 0 1px 4px var(--color-shadow-80);
	float: right;
	height: 100px;
	width: 100px;
	margin-bottom: 1rem;
}
div#gravatar img {
	border-radius: 50px;
	height: 100px;
	width: 100px;
}

/* stories */

ol.stories,
ol.comments,
ol.category_tags {
	padding: 0;
	list-style: none;
	margin: 0;
}

ol.comments {
	margin-left: 20px;
	margin-bottom: 0em;
	padding-left: 6px;
}
ol.comments1 {
	margin-left: -40px;
	padding-left: 0;
}
ol.comments.comments1 {
	border-left-color: transparent;
}
ol.comments1 > li.comments_subtree {
	margin-left: 11px;
}
ol.comments1 > li.comments_subtree > ol.comments {
	margin-left: 0;
	padding-left: 0;
}

.message .voters {
	font-size: 20px;
}

.notifications li {
	margin-bottom: 1lh;
}

div.voters {
	float: left;
	margin-top: 0px;
	text-align: center;
	width: 40px;
}

/* Upvoter triangle styles moved to voting.css */
/* Upvoter styles moved to voting.css */
.upvoter:focus { outline: none; } /* don't outline after upvote click */
.upvoter:focus-visible { outline: 2px solid var(--color-fg-link); } /* do outline when tabbing */

li.story {
	clear: both;
}
ol.stories li.story div.story_liner {
	padding-top: 0.25em;
	padding-bottom: 0.25em;
	word-break: break-word;
}
.comment {
	clear: both;
	padding-top: 0.4em;
	padding-bottom: 0.4em;
	position: relative;
}

.comment a {
	color: var(--color-fg-contrast-7-5);
}

ol.stories li:first-child div.story_liner {
	padding-top: 0.5em;
}
li div.details {
	padding-top: 0.1em;
}

/*
Stories with negative scores are dimmed by decreasing their opacity.
However, if the flag or archive dropdowns have an opacity set, it creates a "stacking context",
which overides the Z index, so the drop down appears under textareas, making them unclickable.
Thus, the selector for opacity must not target those divs or any of their direct parents.
We must also becareful to apply to only children and not any of the parents.
Otherwise it will double apply, resulting in invidual elements being darker.

We'd like to write the following selector to express that directly, but can't until Firefox
supports it:  https://caniuse.com/?search=%3Ahas
.negative_1 *:not(.dropdown_parent, :has(*)) { ... }
*/
.negative_1 *:not(div, .dropdown_parent, .dropdown_parent > div *, .comments_label, .link, .tags, img),
.negative_1 .score {
	opacity: 0.7;
}

.negative_3 *:not(div, .dropdown_parent, .dropdown_parent > div *, .comments_label, .link, .tags, img),
.negative_3 .score {
	opacity: 0.6;
}

.negative_5 *:not(div, .dropdown_parent, .dropdown_parent > div *, .comments_label, .link, .tags, img),
.negative_5 .score {
	opacity: 0.5;
}

.comment.bad *:not(div, .dropdown_parent, .dropdown_parent *) {
	opacity: 0.7;
}

.comment:target, li:target, p:target, div:target, span:target {
	background-color: var(--color-bg-target);
	border-radius: 8px;
}

.showing-user-comment {
	background-color: var(--color-bg-target);
	border-radius: 8px;
	padding: 3px;
}

li .link {
	font-weight: bold;
	vertical-align: middle;
}

li .link a {
	font-size: 11.5pt;
	text-decoration: none;
}

li.story .description_present {
	color: var(--color-fg-contrast-5);
	padding-left: 0.25em;
	text-decoration: none;
	vertical-align: middle;
}

li.story a.tag {
	vertical-align: middle;
}

li .tags {
	margin-right: 0.25em;
}

li .domain {
	color: var(--color-fg-contrast-4-5);
	font-style: italic;
	font-size: 9pt;
	text-decoration: none;
	vertical-align: middle;
}

.merge {
	background: url(merge.svg) no-repeat;
	width: 0.6875lh;
	height: 1lh;
	display: inline-block;
	vertical-align: middle;
}

li input.comment_folder_button {
	display: none;
}
li .comment_folder {
	display: inline-block;
	font-size: 9pt;
	color: var(--color-fg-contrast-4-5);
	letter-spacing: 0.1em;
	width: 1.5em;
	cursor: pointer;
	text-align: center;
}
li .comment_folder:before {
	content: "[−]";
}
li .comment_folder_button:checked ~ .comment .comment_folder:before {
	content: "[+]";
}
/* folding a comment hides the text and voters, but #c_abc123 anchors override */
li .comment_folder_button:checked ~ div.comment:not(:target) div.comment_text {
	display: none;
}
li .comment_folder_button:checked ~ div.comment:not(:target) div.voters .upvoter {
	visibility: hidden;
	margin-bottom: -15px;
}
li .comment_folder_button:checked ~ ol.comments ol,
li .comment_folder_button:checked ~ ol.comments div.comment,
li .comment_folder_button:checked ~ ol.comments li {
	display: none;
}

li.comments_subtree {
	position: relative;
}

li .comment_parent_tree_line {
	position: absolute;
	border-left: 1px dotted var(--color-fg-shape);
	top: 0.5em;
	left: 1em;
	bottom: 0;
}
li .comment_parent_tree_line.score_shown {
	top: 3.6lh;
}
li .comment_siblings_tree_line {
	position: absolute;
	left: -1em;
	border-left: 1px dotted var(--color-fg-shape);
	top: 0;
	bottom: 0;
}
li:last-child > .comment_siblings_tree_line {
	border-left-color: var(--color-bg);
}

.thread_summary {
	color: var(--color-fg-contrast-4-5);
	font-size: 9.5pt;
	/* .comment_folder (-4px margin-left + 1.5em width) + .voters (30px width) */
	margin-left: calc(-4px + 1.5em + 30px);
}
li .byline {
	color: var(--color-fg-contrast-4-5);
	font-size: 9.5pt;
}
li .byline > img.avatar {
	margin-bottom: -5px;
}
li .byline img.avatar {
	border-radius: 8px;
	height: 16px;
	margin-bottom: 2px;
	margin-right: 2px;
	vertical-align: middle;
	width: 16px;
}
li.story .byline {
	margin-top: 1px;
}
.byline a {
	color: var(--color-fg-contrast-4-5);
	text-decoration: none;
}
.comment.replied .flagger,
.comment.flagged .comment_replier {
	color: var(--color-fg);
	cursor: default;
	pointer-events: none;
	text-decoration: line-through;
}
.comment.replied .flagger {
	color: var(--color-fg-contrast-4-5);
}
/* preserve selection made elsewhere when clicking */
li .byline a.comment_replier {
	user-select: none;
}
span.new_user, a.new_user,
li .byline a.new_user {
	color: var(--color-fg-affirmative);
}
span.inactive_user, a.inactive_user,
li .byline a.inactive_user,
.inactive_tag {
	color: var(--color-fg-contrast-5);
	text-decoration: line-through;
}
span.user_is_author, a.user_is_author,
li .byline a.user_is_author {
	color: var(--color-fg-author);
}
li .byline a.story_has_suggestions {
	color: var(--color-lobsters-fg-has-suggestions);
}

.last_read_newest {
	border-bottom: 2px solid var(--color-fg-shape);
	border-top: 0;
	border-left: 0;
	border-right: 0;
	margin: 1em 0 1em 32px; /* matching div.detail */
}

li.story.hidden *:not(div, .dropdown_parent, .dropdown_parent > div *, .comments_label, .link, .tags, img),
li.story.hidden .score {
	opacity: 0.25;
}

ol.show_hidden li.story.hidden {
	opacity: 1.0 !important;
}
li.story.saved a.saver {
	color: var(--color-fg-affirmative);
}

li.story.deleted {
	opacity: var(--opacity-deleted);
}
li.story.deleted a {
	color: var(--color-fg-contrast-5) !important;
}

li div.details {
	margin-left: 32px;
}
div.story_content {
	margin-bottom: 1em;
}
ol.stories.list div.story_content {
	color: var(--color-fg-contrast-6);
	max-height: 2.6em;
	margin: 0.25em 40px 0.25em 0;
	overflow: hidden;
	text-overflow: clip;
}

div.morelink {
	float: left;
}

div.morelink,
div.page_link_buttons {
	margin-top: 1.5em;
}
div.morelink a {
	color: var(--color-fg-contrast-7-5);
	font-weight: bold;
	text-decoration: none;
}
div.page_link_buttons {
	font-weight: bold;
	margin-top: 2em;
}
div.page_link_buttons a,
div.page_link_buttons span {
	border: 1px solid var(--color-box-border);
	background-color: var(--color-button-bg);
	color: var(--color-fg-contrast-7-5);
	padding: 0.25em 0.5em;
	font-weight: bold;
	text-decoration: none;
	margin-left: 0.5em;
}
div.page_link_buttons a.cur,
div.page_link_buttons span {
	background-color: transparent;
	border-color: transparent;
	margin-left: 0.25em;
	padding-right: 0.25em;
}


div.story_text {
	margin-bottom: 1.5em;
	max-width: 700px;
	word-wrap: break-word;
}
div.story_text p {
	margin: 0.75em 0;
}

div#collapsed_story_text {
	display: none;
}
a#story_text_expander {
	display: block;
}

div.comment_text {
	font-size: 10.5pt;
	max-width: 700px;
	word-wrap: break-word;
	overflow: hidden;
}

div.comment_text blockquote,
.markdown_help blockquote,
div.story_text blockquote {
	font-style: italic;
	margin: 0.25em 0 0 0.5em;
	padding: 0 0 0 1em;
	border-left: 2px solid var(--color-fg-contrast-5);
}

/* un-italicize italics inside a blockquote */
div.comment_text blockquote em,
.markdown_help blockquote em,
div.story_text blockquote em {
	font-style: normal
}

div#collapsed_story_text div.story_text blockquote {
	font-style: normal;
}
div.comment_text pre,
.markdown_help pre {
	margin-left: 1em;
}
div.comment_text ol {
	margin: 0;
	padding: 0 1.5em;
}
div.comment_text ol li {
	padding: 0 !important;
	margin: 0 !important;
}

div.comment_text p {
	margin: 0.5em 0;
}
div.comment_text p:first-child {
	margin-top: 0.3em;
}

div.comment_text code {
	line-height: 1.2em;
}

.dropdown_parent {
	position: relative;
}

.comments_subtree .dropdown_parent > #flag_dropdown {
	position: absolute;
	left: 0.25rem;
}

#flag_dropdown, .archive-dropdown {
	position: absolute;
	left: -0.125rem;
	width: 100px;
	border: 1px solid var(--color-box-border);
	border-bottom: 0;
	z-index: 15;
}
#flag_dropdown a, .archive-dropdown a {
	background-color: var(--color-box-bg);
	border-bottom: 1px solid var(--color-box-border);
	color: var(--color-fg-contrast-10);
	display: block;
	font-size: 9pt;
	padding: 3px;
	text-decoration: underline;
}
#flag_dropdown a:hover, .archive-dropdown a:hover {
	background-color: var(--color-box-bg-shaded);
}
#flag_dropdown a.cancel-reason {
	background-color: var(--color-box-bg-shaded);
	font-size: 8pt;
}

#modal_backdrop {
	position: fixed;
	width: 100%;
	height: 100%;
	left: 0;
	top: 0;
	bottom: 0;
	right: 0;
	z-index: 1;
}

/* archive; dropdown styling is with #flag_dropdown to match it */
.archive_button {
	display: none;
}
.archive_button:not(:checked) ~ .archive-dropdown {
	display: none;
}
.archive_button ~ label{
	cursor: pointer;
}



.markdown_help {
	padding-left: 0.25rem;
}

.markdown_help summary {
	color: var(--color-fg-contrast-4-5);
	font-size: 9pt;
	text-align: right;
}
#story_box .markdown_help summary {
	width: calc(7em + 610px);
}

div#story_preview {
	margin-top: 2em;
	margin-left: 3.5em;
}

div#story_box input#story_url {
	width: 512px;
}
div#story_box button#story_fetch_title {
	height: 27px;
	padding-top: 1px;
	padding-bottom: 1px;
	width: 84px;
}
div#story_box input#story_title,
div#story_box input#story_moderation_reason,
div#story_box input#story_merge_story_short_id,
div#domain_box input[type=text] {
	width: 600px;
}
#story_box .url-updated,
#story_box .title-reminder,
#story_box .title-reminder-thanks
{
	display: none;
}
#story_box details ul {
	padding-left: 1em;
}
.slide-down {
	display: block !important;
	transition: height .5s ease !important;
}
div#story_box #story_tags {
	width: 624px;
}
div#story_box textarea {
	width: 600px;
}


div.comment_form_container form {
	margin-left: 40px;
	max-width: 700px;
}

div.comment_form_container textarea {
	box-sizing: border-box;
	width: 100%;
}

.comment_unread {
	color: var(--color-accent);
	font-weight: 600;
	cursor: pointer;
}

/* trees */

.tree,
.tree ul {
	margin: 0 0 0 0.5em;
	padding: 0;
	list-style: none;
	position: relative;
}

.tree ul {
	margin-left: 0.5em;
}

.tree:before,
.tree ul:before {
	border-left: 1px solid var(--color-fg-shape);
	bottom: 0;
	content: "";
	display: block;
	left: 0;
	position: absolute;
	top: 0;
	width: 0;
}

.tree li {
	margin: 0;
	padding: 0 1.1em;
	position: relative;
}

.tree li:before {
	border-top: 1px solid var(--color-fg-shape);
	content: "";
	display: block;
	height: 0;
	left: 0;
	margin-top: -1px;
	position: absolute;
	top: 0.8em;
	width: 8px;
}

.tree li:last-child:before {
	background-color: var(--color-bg);
	border-left: 0;
	bottom: 0;
	height: auto;
}

li.noparent:before,
ul.noparent:before {
	border-top: 0 !important;
	border-left: 0 !important;
}

ul.user_tree {
	color: var(--color-fg-contrast-4-5);
}

/* /~:username/standing */
/* https://codepen.io/sosuke/pen/Pjoqqp */
.unwarned {
	filter: invert(36%) sepia(52%) saturate(0%) hue-rotate(292deg) brightness(96%) contrast(85%);
}
.warned, .jaccuse {
	filter: invert(13%) sepia(85%) saturate(4911%) hue-rotate(356deg) brightness(78%) contrast(95%);
}
table.standing tr td { vertical-align: top; }
table.standing td:first-child { text-align: right }
td.warned div, td.unwarned div {
	display: inline-block;
	height: 1em;
	line-height: 1em;
	text-align: center;
	width: 1em;
}

/* /mod dashbaord */

.mod {
	color: var(--color-accent);
}
.modmodlog .mod td:first-child {
	border-left: 2pt solid var(--color-accent);
}
.nominal {
	color: var(--color-accent);
	font-size: 2em;
	text-align: center;
}
.mod_activities {
	padding: 0;
}
.mod_activities li ul {
	list-style-type: none;
	padding: 0;
}
.mod_activities .moderation {
	list-style: '🕮';
}
.mod_activities .mod_note {
	list-style: '🔑';
}

/* data tables */

table.data th {
	background-color: var(--color-table-header-bg);
	border-bottom: 1px solid var(--color-table-header-border);
	border-top: 1px solid var(--color-table-header-border);
	text-align: left;
}
table.data th img {
	margin-bottom: 5px;
}

table.data th.r, table.data td.r {
	text-align: right;
	padding-right: 3px;
}

table.data th,
table.data td {
	padding: 0.25em 0.5em;
}

table.data tr.bold td {
	font-weight: bold;
}

table.data.zebra tr:nth-child(even) td,
.mod_activities li:nth-child(even) {
	background-color: var(--color-table-row-bg-even);
	border-bottom: 1px solid var(--color-table-row-border);
}
table.data.zebra tr:nth-child(odd) td,
.mod_activities li:nth-child(odd) {
	background-color: var(--color-table-row-bg-odd);
	border-bottom: 1px solid var(--color-table-row-border);
}
table.data tr.nobottom td {
	border-bottom: 0px;
	padding-bottom: 0px;
}
table.data tr.nobottom td.wrap {
	overflow-wrap: anywhere;
}
table.data.tall td {
	vertical-align: top;
}

table.data td p:first-child {
	margin-top: 0;
}
table.data td p:last-child {
	margin-bottom: 0;
}
table.data pre {
	overflow-x: scroll;
	max-width: 800px;
}
table.moderations tr > td:nth-child(1) {
	white-space: nowrap;
}

/* boxes */

.box label {
	display: block;
	float: left;
	margin-bottom: 4px;
}

label.required {
	font-weight: bold;
}
.box img {
	vertical-align: middle;
}
.box label,
.box > span,
.box select,
.box br {
	line-height: 2em;
}
.box br {
	clear: left;
}
.box .boxline {
	clear: both;
	margin-bottom: 0.5em;
}
.box p {
	margin-top: 1em;
}

.box textarea {
	margin-bottom: 4px;
	width: 75%;
}

.box label {
	width: 7em;
	line-height: 2em;
	vertical-align: middle;
}
.box div.d {
	margin-left: 7em;
}

.box input.normal,
.box label.normal {
	display: inline;
	float: none;
	vertical-align: middle;
}

.box span.d label,
.box td label,
.box div.d label {
	display: inline;
	float: none;
	vertical-align: baseline;
}

.box span.d a.tag {
	vertical-align: middle;
}

.row {
	display: flex;
	gap: 1rem;
	flex-wrap: wrap;
}

.labelled_grid {
	display: grid;
	grid-template-columns: minmax(10rem, min-content) 1fr;
	word-break: break-word;
	column-gap: 1rem;
	row-gap: 12px;
}

.labelled_grid textarea,
.labelled_grid input[type="text"],
.labelled_grid input[type="password"] {
	width: 100%;
	box-sizing: border-box;
}
.labelled_grid input[type="text"],
.labelled_grid input[type="password"] {
	height: 1.5rlh;
}

.labelled_grid input[type="checkbox"] {
	margin: 0;
	vertical-align: middle;
	width: min-content;
}

.labelled_grid input[type="radio"] {
	margin: 0;
	vertical-align: middle;
}

.labelled_grid select {
	margin: 0;
}

.labelled_grid > p {
	grid-column: 1 / -1;
}

section + section {
	margin-top: 2rem;
}

section section + section {
	margin-top: 1.5rem;
}

input[type="submit"]:not(.link_post) {
	margin-top: 1rem;
}

span.hint {
	margin-left: 0.25rem;
}

div.hint {
	margin-top: 0.25rem;
}

.user-stats p {
	margin-top: 1em;
}

.user-stats br {
	line-height: 2em;
}

.hint {
	color: var(--color-fg-contrast-5);
	font-style: italic;
}
.hint.indent {
	margin-left: 12em;
}

.box.wide label {
	width: 12em;
}
.box.wide div.d {
	margin-left: 12em;
}

.display-block {
	display: block;
}

/* for flash_notices() and flash_errors() */

div.flash-error,
div.flash-notice,
div.flash-success,
div.user-stats {
	position: relative;
	padding: 7px 15px;
	margin-bottom: 18px;
	border-color: var(--color-shadow-10) var(--color-shadow-10) var(--color-shadow-25);
	border-width: 1px;
	border-style: solid;
	border-radius: 4px;
	box-shadow: inset 0 1px 0 var(--color-light-25);
}
div.flash-error a,
div.flash-notice a,
div.flash-success a {
	font-weight: bold;
	color: var(--color-fg-contrast-13);
}
div.flash-error .similar a,
div.flash-notice .similar a,
div.flash-success .similar a,
div.user-stats a {
	font-weight: normal;
}
div.flash-error div,
div.flash-notice div,
div.flash-success div {
	margin-top: 5px;
	margin-bottom: 2px;
	line-height: 28px;
}
div.flash-error {
	background-color: var(--color-flash-bg-error);
}
div.flash-success {
	background-color: var(--color-flash-bg-success);
}
div.flash-notice {
	background-color: var(--color-flash-bg-notice);
}
div.user-stats {
	background-color: var(--color-box-bg-shaded);
}

div.flash-error h2,
div.flash-notice h2,
div.flash-success h2,
div.user-stats h2 {
	font-size: 1.25em;
	margin: 0;
}

/* Using #story_holder for precedence over TomSelect's vendored CSS  */

#story_holder .ts-control {
	background-color: var(--color-box-bg);
	border: 1px solid var(--color-box-border);
	border-radius: 0px;
	box-shadow: none;
	box-sizing: border-box;
	margin-bottom: 2px;
	padding: 2px 0 0px 5px;
	/* supposed to be inherited from body, but TS overwrites */
	font-family: "helvetica neue", arial, sans-serif;
	font-size: 13.33px;
	color: var(--color-fg);
	line-height: 1.5rem;
}

#story_holder .ts-control:focus-within {
	border-color: var(--color-box-border-focus)
}

#story_holder .ts-control .data-ts-item { /* item already selected by user*/
	color: var(--color-fgcontrast-10);
	line-height: 13px;
	margin: 3px 5px 3px 0;
	padding: 3px 0.5rem 3px 1rem !important;
	position: relative;
	cursor: default;
}

#story_holder .ts-control .data-ts-item a {
	display: block;
	position: absolute;
	height: 13px;
	padding: 2px;
	left: 0px;
	margin-left: 0;
	/*
	For a decade, select2 had the `x` to remove a tag on the left. TomSelect puts it
	on the right, so we hide that and insert an`x` on the left with `a::after` below.
	*/
	visibility: hidden;
}

#story_holder .ts-control .data-ts-item a::after {
	content: "\2715";
	display: block;
	position: absolute;
	color: grey;
	font-size: 10px;
	outline: none;
	padding-right: 3px;
	top: 0px;
	width: 12px;
	cursor: pointer;
	visibility: visible;
}

#story_holder .ts-dropdown {
	position: relative;
	width: 100%;
	background: #fff;
	background-color: var(--color-box-bg);
	border-color: var(--color-box-border-focus);
	border-radius: 0 0 4px 4px;
	border-top: 1px solid #aaa;
	box-shadow: 0 4px rgb(0 0 0 / 15%);
	margin: 0px;
	padding: 0px;
	z-index: 999;
}

#story_holder .ts-dropdown .ts-dropdown-content .active {
	background: var(--color-bg-accent);
	color: var(--color-box-bg);
}

#story_holder .ts-dropdown-content {
	max-height: 200px;
	padding: 0;
	position: relative;
	overflow-x: hidden;
	overflow-y: scroll;
}

#story_holder .ts-dropdown .option {
	color: var(--color-fg);
	font-family: "helvetica neue", arial, sans-serif;
	line-height: 80%;
	margin: 0px;
	padding: 7px 7px 8px;
	cursor: pointer;
}

/* pushover */
input[type="submit"].link_post.pushover_button {
	box-sizing: border-box;
	background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QAJQCeAPHNVUx7AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3wEPAh02ee0QVwAAACZpVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVAgb24gYSBNYWOV5F9bAAABqElEQVQ4y62TvUtbURjGf+fek2vQpMF2ED9QkfpR6VLaDoIEF0UKWQRBQ+yQP6GDU0Xw4y/obOgg6dDSJVS61MlBcXFQB6M1BsF+IES9NnrzcRy8xpvrBwH7bOflfc553+d5jsCF9tiRDwgBEaDXLi8B80AiGQ2Yzn7hIo8Cce5HOBkNfLo6aA7ydAVkgLjdez3BrS8rRbBJEmyU+AyBVVDE1i1SJ6psEmHvfOLktj0SjL/2snKQx8wpNg+LBJt0RjoN+j6bqOvN/ZotWAldtYK5gWpmV84YbPUw2ePlb7bI73+Kep+OLFONkGarXcK7l16+7+V57BW8qJMs7Ob5k4VQm4fVXzlyquyGiHRYBcC+WWQxnSP63AAgtn7O0FNJ9xOd0W+nbkF7pbsytXxOQw30N0t2MgX6Wzy8qtMJL5zy81jdsETaIXnjLL7trkLqGl+2svxI5/mwZt1l6ZJmJ6yEGqkYbveQOioQ2yiz7TbMa0DCWRnuMPBXaXzcsJx23YWEZmc7fJkqxdgzg8xZka/bFhVE2hSuKL+nMswko4GJ//KZxEO/8wVmfpjJTWeCTQAAAABJRU5ErkJggg==) 2px 2px no-repeat, linear-gradient(var(--color-fg-gradient-lit), var(--color-fg-gradient-shadowed));
	border: 1px solid var(--color-box-border);
	border-radius: 3px;
	color: var(--color-fg);
	display: inline-block;
	font: 11px/18px "Helvetica Neue",Arial,sans-serif;
	font-weight: bold;
	cursor: pointer;
	height: 22px;
	padding-left: 20px;
	padding-right: 5px;
	overflow: hidden;
	text-shadow: 0px 1px 0px var(--color-bg-50);
	text-decoration: none;
	vertical-align: middle;
}

/* search */

.searchresults summary .heading {
	font-weight: bold;
	font-size: 11pt; /* h2 */
}
.searchresults summary {
	margin: 1em 0;
}
.search_parse dd {
	margin-bottom: 0.5em;
}
.searchq {
	background: var(--color-box-bg-shaded);
	border-radius: 4px;
	font-family: monospace;
	padding: 2px;
}


@media screen and (min-width: 481px) {
	body {
		max-width: 900px;
		padding-bottom: 2em;
	}

	header#nav {
		margin: 1em 0 0.5rem 0;
		padding: 5px 10px;
	}
	header#nav nav.links {
		flex-flow: row wrap;
		justify-content: start;
	}
	header#nav nav.links > .corner {
		display: inline;
		margin-left: auto;
	}
	header#nav nav.corner {
		display: none;
	}
	header#subnav a:last-child {
		margin-right: 0.5rem;
	}

	div#inside {
		margin-left: calc(
			10px +   /* header#nav padding-left */
			18px +   /* #logo width + padding l/r */
			0.25rem + /* header#nav a margin-right for logo */
			0.25rem   /* header#nav a margin-left for first link in header#nav */
		);
		margin-right: 10px; /* header#nav padding-right */
	}

	/* hang voters into left margin to center under logo */
	ol.stories,
	#inside > ol.comments {
		/* .voters width + .voters padding-right */
		margin-left: -32px;
	}
	ol.stories div.voters,
	#inside > ol.comments div.voters {
		width: 30px;
	}
	.labelled_grid > label:after {
		content: ':';
	}

	.help {
		margin-top: 2em;
	}


	div#story_box .actions {
		margin-left: 7em;
		width: 610px;
	}
	#story_holder .ts-control {
		display: inline-block;
		position: absolute;
		width: 611px;
	}
}

@media only screen and (max-width: 480px) {
	html {
		-webkit-text-size-adjust: none;
	}

	header#nav .corner .inbox {
		font-size: 18px;
		vertical-align: bottom;
	}
	header#nav .corner .inbox .inbox_unread {
		font-size: 10pt;
	}
	header#nav {
		background-color: var(--color-box-bg-shaded);
		border-bottom: 1px solid var(--color-box-border);
		flex-flow: row nowrap;
		height: 44px;
		min-width: 100%;
		padding-top: 0.75rem;
	}
	header#nav nav.links {
		flex-wrap: nowrap;
		overflow-x: auto;
		overflow-y: clip;
	}

	header#nav .navholder:before, header#nav .navholder:after {
		content: "";
		height: 100%;
		pointer-events: none;
		position: absolute;
		top: 0px;
		width: 2em;
		z-index: 1;
	}
	header#nav .navholder:before {
		background: linear-gradient(to right, var(--color-box-bg-shaded), transparent);
		left: -1em;
	}
	header#nav .navholder:after {
		right: 0px;
		background: linear-gradient(to right, transparent, var(--color-box-bg-shaded));
	}
	header#nav nav.links > .corner {
		display: none;
	}
	header#nav nav.corner {
		display: block;
	}
	header#subnav {
		background-color: var(--color-box-bg-shaded);
	}
	header#subnav a:last-child {
		margin-right: 0.75rem;
	}

	header#nav .user {
		display: inline;
		margin-top: 0.25em;
		clear: both;
	}

	header#nav a {
		padding-right: 0.25em;
		padding-left: 0;
	}
	div#inside {
		margin: 0.5rem;
	}

	.comment {
		padding-left: 0;
	}

	.comment .preview {
		padding-left: 25px;
	}

	ol.comments { margin-left: 10px }
	ol.stories,
	div#inside > ol.comments {
		margin: 0 0 0 -0.5rem;
		padding-left: 0;
	}
	ol.comments1 > li.comments_subtree {
		margin-left: 0;
	}

	li .comment_siblings_tree_line {
		border-left: transparent;
	}

	div.voters {
		margin-left: 0.25em;
		margin-top: 0px;
		width: 30px;
	}

	div.comment_form_container {
		margin-left: 0;
	}

	div.comment_form_container form {
		margin-left: 35px;
	}

	/* Mobile upvoter styles handled in voting.css */

	ol.stories.list {
		margin-top: 0;
	}

	ol.stories.list li.story {
		display: table;
	}
	ol.stories.list li.story div.story_liner {
		background-color: var(--color-mobile-story-liner-bg);
		display: table-cell;
		padding-top: 0.5em;
		padding-bottom: 0.75em;
		width: 100%;
	}
	ol.stories.list li.story .mobile_comments {
		display: table-cell !important;
		font-size: 11pt;
		min-width: 40px;
		text-align: center;
		text-decoration: none;
		vertical-align: middle;
	}
	ol.stories.list li.story .mobile_comments span:before {
		border-style: solid;
		border-width: 0px 6px 3px 0px;
		border-color: var(--color-mobile-story-comments-bubble-fill);
		border-bottom-right-radius: 13px;
		bottom: -10px;
		content: "";
		display: block;
		height: 7px;
		left: 4px;
		position: absolute;
		width: 5.4px;
		z-index: 10;
	}
	ol.stories.list li.story .mobile_comments span:after {
		border-bottom-right-radius: 10px;
		border-color: var(--color-mobile-story-comments-bubble-fill);
		border-style: solid;
		border-width: 0px 3px 3px 0px;
		bottom: -10px;
		content: "";
		display: block;
		height: 7px;
		left: 5px;
		position: absolute;
		width: 10px;
		z-index: 10;
	}
	ol.stories.list li.story .mobile_comments span {
		background-color: var(--color-mobile-story-comments-bubble-fill);
		border: 1px solid var(--color-mobile-story-comments-bubble-fill);
		border-radius: 5px;
		color: var(--color-fg);
		display: block;
		font-size: 9pt;
		margin: 0 0.5em;
		padding: 2px;
		position: relative;
		text-align: center;
	}
	ol.stories.list li.story .mobile_comments:active span,
	ol.stories.list li.story .mobile_comments:focus span {
		outline: 0;
	}
	ol.stories.list li.story .mobile_comments.zero span {
		background-color: var(--color-mobile-story-comments-bubble-fill-zero);
		color: var(--color-fg-contrast-4-5);
	}
	ol.stories.list li.story .mobile_comments.zero span,
	ol.stories.list li.story .mobile_comments.zero span:before,
	ol.stories.list li.story .mobile_comments.zero span:after {
		border-color: var(--color-mobile-story-comments-bubble-fill-zero);
	}
	ol.stories.list li.story .comments_label {
		display: none;
	}

	li div.details {
		margin: 0 0 0 36px;
	}
	div.story_content {
		margin: 0 0 0 28px;
	}
	div.morelink {
		margin-left: 28px;
		float: none;
	}
	li.story div.byline {
		font-size: 10pt;
	}

	div.box label,
	div.boxline label {
		display: block;
		width: 100% !important;
	}
	div.box div.d,
	div.box.wide div.d {
		margin-left: 0;
	}

	div.boxline textarea,
	div.boxline input[type="text"],
	div.comment textarea {
		max-width: 90%;
	}

	div#story_box input,
	div#story_box button,
	div#story_box textarea,
	div#story_box #story_tagsa,
	div.actions {
		margin: 0 !important;
	}

	div#story_box #story_tags {
		min-width: 305px !important;
	}

	div#gravatar {
		float: none;
	}

	div#user_about {
		margin-left: 0;
	}

	#story_holder .ts-wrapper .multi {
		margin-left: 0rem;
	}

	footer nav {
		text-align: right;
	}
	.indent {
		margin-left: 2em;
	}


	.labelled_grid {
		grid-template-columns: minmax(5rem, min-content) 1fr;
	}

	/* For the mobile view of the grid, we want most things to be full-width */
	.labelled_grid > * {
		grid-column: 1 / -1;
	}

	/*
	   Checkbox controls, however, should appear inline. For these, we want to put
	   the label in column 1, and the control (or its container) in column 2.
	*/
	.labelled_grid	label.for_checkbox {
		grid-column: 1;
	}

	.labelled_grid > input[type="checkbox"],
	.labelled_grid > *:has(input[type="checkbox"]) {
		grid-column: 2;
	}

	/* Add a colon to the label for checkboxes, as in the desktop view */
	.labelled_grid	label.for_checkbox:after {
		content: ":";
	}

	/* Force hints onto the next line, with no indent */
	.labelled_grid input[type="checkbox"]:has(+ .hint) {
		display: block;
	}
	.labelled_grid input[type="checkbox"] + .hint {
		margin-left: 0;
	}
}
@media print {
	.comment_folder,
	.comment_form {
		display: none;
	}
}

/* PWA and Mobile Enhancements */

/* Offline state indicator */
body.offline {
	position: relative;
}

body.offline::before {
	content: "⚠ Offline Mode";
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	background: #f44336;
	color: white;
	text-align: center;
	padding: 4px 8px;
	font-size: 11px;
	z-index: 9999;
	animation: slideDown 0.3s ease;
}

@keyframes slideDown {
	from { transform: translateY(-100%); }
	to { transform: translateY(0); }
}

/* PWA Install Banner Styles (handled by JavaScript, but adding base styles) */
#pwa-install-banner {
	font-family: "helvetica neue", arial, sans-serif;
	box-sizing: border-box;
}

#pwa-install-banner button {
	font-family: inherit;
	cursor: pointer;
	transition: all 0.2s ease;
}

#pwa-install-banner button:hover {
	transform: translateY(-1px);
	box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

/* Connection status indicator */
#connection-status {
	font-family: "helvetica neue", arial, sans-serif;
	font-size: 12px;
	box-sizing: border-box;
}

/* Enhanced touch targets for mobile */
@media (max-width: 480px) {
	/* Larger touch targets */
	.story .voting, 
	.comment .voting {
		min-width: 44px;
		min-height: 44px;
		display: flex;
		align-items: center;
		justify-content: center;
	}
	
	/* Better button spacing */
	input[type="submit"], 
	button {
		min-height: 44px;
		padding: 12px 16px;
		margin: 8px 4px;
	}
	
	/* Improved form controls */
	input[type="text"], 
	input[type="email"], 
	input[type="password"], 
	textarea {
		min-height: 44px;
		padding: 12px;
		font-size: 16px; /* Prevents zoom on iOS */
		border-radius: 4px;
	}
	
	/* Better navigation spacing */
	#navigation ul li {
		margin: 0 4px;
	}
	
	#navigation ul li a {
		padding: 12px 8px;
		display: block;
	}
	
	/* Swipe-friendly story list */
	.story {
		position: relative;
		padding: 16px 12px;
		border-bottom: 1px solid var(--color-fg-contrast-5);
	}
	
	/* Pull-to-refresh indicator */
	.pull-to-refresh {
		text-align: center;
		padding: 20px;
		color: var(--color-fg-contrast-6);
		font-size: 14px;
	}
	
	/* Loading states */
	.loading {
		opacity: 0.6;
		pointer-events: none;
	}
	
	.loading::after {
		content: "";
		position: absolute;
		top: 50%;
		left: 50%;
		width: 20px;
		height: 20px;
		margin: -10px 0 0 -10px;
		border: 2px solid var(--color-fg-contrast-5);
		border-top: 2px solid var(--color-fg);
		border-radius: 50%;
		animation: spin 1s linear infinite;
	}
	
	@keyframes spin {
		0% { transform: rotate(0deg); }
		100% { transform: rotate(360deg); }
	}
}

/* Landscape mode optimizations */
@media (max-height: 480px) and (orientation: landscape) {
	/* Reduce header height in landscape */
	#header {
		padding: 8px 0;
	}
	
	.logo img {
		width: 30px;
		height: 30px;
	}
	
	/* Compact navigation */
	#navigation ul li a {
		padding: 8px 6px;
		font-size: 9pt;
	}
}

/* High DPI / Retina display optimizations */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
	/* Crisp 1px borders */
	.story, .comment {
		border-bottom-width: 0.5px;
	}
	
	/* Better icon rendering */
	.voting img, .icon {
		image-rendering: -webkit-optimize-contrast;
		image-rendering: crisp-edges;
	}
}

/* Additional dark theme enhancements */
input[type="text"], 
input[type="email"], 
input[type="password"], 
input[type="url"],
textarea, 
select {
	background-color: #222222;
	border: 1px solid #444444;
	color: var(--color-fg);
}

input[type="text"]:focus, 
input[type="email"]:focus, 
input[type="password"]:focus, 
input[type="url"]:focus,
textarea:focus {
	border-color: var(--color-accent);
	outline: none;
	box-shadow: 0 0 3px var(--color-accent);
}

button, 
input[type="submit"] {
	background-color: var(--color-accent);
	border: 1px solid var(--color-accent-dark);
	color: white;
	padding: 8px 16px;
	border-radius: 4px;
	cursor: pointer;
}

button:hover, 
input[type="submit"]:hover {
	background-color: var(--color-accent-hover);
}

/* Dark theme for error pages and notifications */
.notification-prompt {
	background: #1a1a1a !important;
	border-color: #444444 !important;
	color: var(--color-fg) !important;
}

.notification-prompt button.primary {
	background: var(--color-accent) !important;
	border-color: var(--color-accent-dark) !important;
}

/* Dark mode support for PWA */
@media (prefers-color-scheme: dark) {
	/* Enhance existing dark mode for PWA */
	:root {
		--pwa-status-bg: #333;
		--pwa-status-text: #fff;
	}
	
	#connection-status {
		background: var(--pwa-status-bg) !important;
		color: var(--pwa-status-text) !important;
	}
}

/* Reduce motion for accessibility */
@media (prefers-reduced-motion: reduce) {
	*, *::before, *::after {
		animation-duration: 0.01ms !important;
		animation-iteration-count: 1 !important;
		transition-duration: 0.01ms !important;
	}
}

/* Enhanced focus states for keyboard navigation */
a:focus, button:focus, input:focus, textarea:focus, select:focus {
	outline: 2px solid var(--color-accent);
	outline-offset: 2px;
}

/* Skip to content link for accessibility */
.skip-to-content {
	position: absolute;
	top: -40px;
	left: 6px;
	background: var(--color-accent);
	color: white;
	padding: 8px;
	text-decoration: none;
	z-index: 1000;
	border-radius: 4px;
}

.skip-to-content:focus {
	top: 6px;
}

/* Story Form Styling */
.story-form {
	max-width: 800px;
	margin: 2rem auto;
	padding: 0 1rem;
}

.story-form .form-group {
	margin-bottom: 1.5rem;
}

.story-form .form-group label {
	display: block;
	margin-bottom: 0.5rem;
	font-weight: bold;
	color: var(--color-fg);
}

.story-form input[type="text"],
.story-form input[type="url"], 
.story-form textarea {
	width: 100%;
	max-width: 100%;
	box-sizing: border-box;
	padding: 12px;
	border: 1px solid #444444;
	background-color: #222222;
	color: var(--color-fg);
	font-family: inherit;
	font-size: 11pt;
	border-radius: 4px;
}

.story-form textarea {
	min-height: 120px;
	resize: vertical;
}

.story-form input[type="text"]:focus,
.story-form input[type="url"]:focus,
.story-form textarea:focus {
	outline: none;
	border-color: var(--color-accent);
	box-shadow: 0 0 0 2px rgba(255, 68, 68, 0.2);
}

.story-form small {
	display: block;
	margin-top: 0.25rem;
	color: var(--color-fg-contrast-5);
	font-size: 9pt;
}

.story-form .form-actions {
	margin-top: 2rem;
	padding-top: 1rem;
	border-top: 1px solid var(--color-box-border);
}

.story-form .form-actions button,
.story-form .form-actions .cancel {
	display: inline-block;
	margin-right: 1rem;
	padding: 12px 24px;
	text-decoration: none;
	border-radius: 4px;
	font-weight: bold;
	transition: all 0.2s ease;
}

.story-form .form-actions button {
	background-color: var(--color-accent);
	color: white;
	border: 1px solid var(--color-accent);
	cursor: pointer;
}

.story-form .form-actions button:hover {
	background-color: var(--color-accent-hover);
	transform: translateY(-1px);
	box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

.story-form .form-actions .cancel {
	background-color: transparent;
	color: var(--color-fg-contrast-6);
	border: 1px solid var(--color-box-border);
}

.story-form .form-actions .cancel:hover {
	background-color: var(--color-box-bg-shaded);
	color: var(--color-fg);
}

/* Responsive adjustments */
@media (max-width: 768px) {
	.story-form {
		margin: 1rem auto;
		padding: 0 0.5rem;
	}
	
	.story-form .form-actions button,
	.story-form .form-actions .cancel {
		display: block;
		width: 100%;
		margin-bottom: 0.5rem;
		margin-right: 0;
		text-align: center;
	}
}

/* Performance Optimizations */

/* Lazy loading image states */
img[data-src] {
	background: var(--color-fg-contrast-5);
	min-height: 100px;
	transition: opacity 0.3s ease;
}

img[data-src].lazy-placeholder {
	opacity: 0.7;
	filter: blur(2px);
}

img[data-src].loaded {
	opacity: 1;
	filter: none;
}

/* Loading indicators */
.loading-indicator {
	display: none;
	text-align: center;
	padding: 20px;
	color: var(--color-fg-contrast-6);
}

.loading-spinner {
	display: inline-block;
	width: 20px;
	height: 20px;
	border: 2px solid var(--color-fg-contrast-5);
	border-radius: 50%;
	border-top-color: var(--color-accent);
	animation: spin 1s ease-in-out infinite;
	margin-right: 10px;
}

/* Infinite scroll sentinel */
.scroll-sentinel {
	height: 20px;
	margin: 20px 0;
}

/* Virtual scrolling container */
[data-virtual-scroll] {
	overflow-y: auto;
	position: relative;
}

.virtual-item {
	position: absolute;
	left: 0;
	right: 0;
	transition: transform 0.2s ease;
}

/* Content shifting prevention */
.content-container {
	min-height: 100vh;
	contain: layout style paint;
}

/* Image optimization */
img {
	max-width: 100%;
	height: auto;
	display: block;
}

/* WebP support with fallback */
.webp img[data-webp] {
	background-image: attr(data-webp url);
}

.no-webp img[data-webp] {
	background-image: attr(src url);
}

/* Critical resource preloading hints */
.preload-hint {
	display: none;
}

/* Performance monitoring overlay (dev only) */
.perf-monitor {
	position: fixed;
	top: 10px;
	right: 10px;
	background: rgba(0, 0, 0, 0.8);
	color: white;
	padding: 10px;
	font-family: monospace;
	font-size: 12px;
	border-radius: 4px;
	z-index: 9999;
	max-width: 300px;
}

.perf-metric {
	margin: 2px 0;
}

.perf-metric.good { color: #4caf50; }
.perf-metric.needs-improvement { color: #ff9800; }
.perf-metric.poor { color: #f44336; }

/* Deferred content loading */
.deferred-content {
	opacity: 0;
	transition: opacity 0.3s ease;
}

.deferred-content.loaded {
	opacity: 1;
}

/* Social widget placeholder */
.social-widget-placeholder {
	background: var(--color-fg-contrast-5);
	border: 1px dashed var(--color-fg-contrast-4-5);
	padding: 20px;
	text-align: center;
	color: var(--color-fg-contrast-6);
	cursor: pointer;
	border-radius: 4px;
	transition: background-color 0.2s ease;
}

.social-widget-placeholder:hover {
	background: var(--color-fg-contrast-4-5);
}

/* Efficient animations */
.fade-in {
	animation: fadeIn 0.3s ease-in;
}

.slide-up {
	animation: slideUp 0.3s ease-out;
}

@keyframes fadeIn {
	from { opacity: 0; }
	to { opacity: 1; }
}

@keyframes slideUp {
	from { 
		opacity: 0;
		transform: translateY(20px);
	}
	to { 
		opacity: 1;
		transform: translateY(0);
	}
}

/* GPU acceleration for smooth scrolling */
.smooth-scroll {
	-webkit-overflow-scrolling: touch;
	transform: translateZ(0);
	will-change: scroll-position;
}

/* Image error state */
img.image-error {
	background: var(--color-fg-contrast-5);
	color: var(--color-fg-contrast-6);
	font-size: 12px;
	display: flex;
	align-items: center;
	justify-content: center;
	min-height: 100px;
}

img.image-error::after {
	content: "Image failed to load";
}

/* Connection status indicator */
.connection-status {
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	background: #f44336;
	color: white;
	text-align: center;
	padding: 8px;
	font-size: 14px;
	z-index: 1000;
	transform: translateY(-100%);
	transition: transform 0.3s ease;
}

.connection-status.show {
	transform: translateY(0);
}

.connection-status.online {
	background: #4caf50;
}

/* Reduce layout thrashing */
.layout-stable {
	contain: layout;
}

/* Resource hints for critical assets */
.critical-resource {
	font-display: swap; /* For fonts */
}

/* Memory-efficient list rendering */
.optimized-list {
	overflow: hidden;
	contain: strict;
}

.optimized-list-item {
	contain: layout style paint;
	will-change: auto;
}

/* Battery saving mode */
@media (prefers-reduced-motion: reduce) {
	.loading-spinner,
	.loading::after {
		animation: none;
	}
	
	.fade-in,
	.slide-up {
		animation: none;
	}
}

/* Print optimizations */
@media print {
	.loading-indicator,
	.connection-status,
	.perf-monitor {
		display: none !important;
	}
	
	img[data-src] {
		opacity: 1;
		filter: none;
	}
}
@media (prefers-reduced-motion: no-preference) {
	a:focus, button:focus, input:focus, textarea:focus {
		outline: 3px solid var(--color-fg);
		outline-offset: 2px;
		transition: outline 0.2s ease;
	}
}

/* PWA specific display modes */
@media (display-mode: standalone) {
	/* App is running as PWA */
	body {
		/* Add any PWA-specific styles */
		padding-top: env(safe-area-inset-top);
		padding-left: env(safe-area-inset-left);
		padding-right: env(safe-area-inset-right);
		padding-bottom: env(safe-area-inset-bottom);
	}
	
	/* Hide browser-specific elements when in PWA mode */
	.browser-only {
		display: none;
	}
}

/* iOS Safari specific fixes */
@supports (-webkit-touch-callout: none) {
	/* Fix for iOS Safari bottom padding */
	body {
		padding-bottom: env(safe-area-inset-bottom);
	}
	
	/* Fix for iOS Safari input zoom */
	input[type="text"], 
	input[type="email"], 
	input[type="password"], 
	textarea {
		font-size: 16px;
	}
}

/* Notification permission prompt styles */
.notification-prompt {
	position: fixed;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%);
	background: white;
	border: 1px solid var(--color-fg-contrast-5);
	border-radius: 8px;
	padding: 20px;
	box-shadow: 0 4px 12px rgba(0,0,0,0.3);
	z-index: 10000;
	max-width: 300px;
	text-align: center;
}

.notification-prompt h3 {
	margin: 0 0 10px 0;
	color: var(--color-fg);
}

.notification-prompt p {
	margin: 0 0 15px 0;
	color: var(--color-fg-contrast-7-5);
	font-size: 9pt;
	line-height: 1.4;
}

.notification-prompt button {
	margin: 0 5px;
	padding: 8px 16px;
	border: 1px solid var(--color-fg-contrast-5);
	border-radius: 4px;
	background: white;
	color: var(--color-fg);
	cursor: pointer;
}

.notification-prompt button.primary {
	background: #ff6600;
	color: white;
	border-color: #ff6600;
}

/* Comment styles */
.comments-section {
	margin-top: 20px;
}

.comment-form-container {
	margin-bottom: 20px;
}

.comment-form {
	background: var(--color-bg);
	border: 1px solid var(--color-fg-contrast-4-5);
	border-radius: 4px;
	padding: 15px;
}

.comment-form textarea {
	width: 100%;
	box-sizing: border-box;
	resize: vertical;
	min-height: 100px;
}

.comment {
	border-left: 2px solid var(--color-fg-contrast-4-5);
	margin: 10px 0;
	padding: 10px 0 10px 15px;
	display: flex;
	align-items: flex-start;
}

.comment-header {
	display: flex;
	align-items: flex-start;
	margin-bottom: 8px;
	width: 100%;
}

.comment-meta {
	flex: 1;
	margin-left: 8px;
}

.comment-content {
	margin-left: 28px;
	color: var(--color-fg);
	line-height: 1.4;
}

.comment-actions {
	display: inline-block;
	margin-left: 10px;
}

.comment-actions a {
	color: var(--color-fg-contrast-7-5);
	text-decoration: none;
	margin-right: 8px;
	font-size: 10pt;
}

.comment-actions a:hover {
	color: var(--color-fg-link);
}

.reply-form {
	margin: 10px 0 10px 28px;
}

.comment-replies {
	margin-left: 20px;
	border-left: 1px solid var(--color-fg-contrast-4-5);
}

.deleted-comment {
	color: var(--color-fg-contrast-7-5);
	font-style: italic;
}

.username {
	color: var(--color-fg-link);
	text-decoration: none;
	font-weight: bold;
}

.username:hover {
	color: var(--color-fg-link-hover);
}

.timestamp a {
	color: var(--color-fg-contrast-7-5);
	text-decoration: none;
	font-size: 10pt;
}

.timestamp a:hover {
	color: var(--color-fg-link);
}

/* User Profile Styles */
.user-profile {
	max-width: 800px;
	margin: 0 auto;
	padding: 20px;
}

.user-header {
	display: flex;
	justify-content: space-between;
	align-items: flex-start;
	margin-bottom: 30px;
	padding-bottom: 20px;
	border-bottom: 1px solid var(--color-fg-contrast-4-5);
}

.user-basic-info .username {
	margin: 0 0 10px 0;
	color: var(--color-fg);
	font-size: 24px;
}

.badge {
	font-size: 12px;
	padding: 2px 8px;
	border-radius: 3px;
	margin-left: 10px;
	font-weight: normal;
}

.badge.admin {
	background: var(--color-accent);
	color: white;
}

.badge.moderator {
	background: var(--color-fg-link);
	color: white;
}

.user-hats {
	margin-top: 10px;
}

.hat {
	display: inline-block;
	background: var(--color-bg-50);
	border: 1px solid var(--color-fg-contrast-4-5);
	padding: 2px 8px;
	margin-right: 5px;
	border-radius: 3px;
	font-size: 11px;
	color: var(--color-fg-contrast-7-5);
}

.hat a {
	color: var(--color-fg-link);
	text-decoration: none;
}

.user-stats {
	display: flex;
	gap: 20px;
}

.stat {
	text-align: center;
}

.stat-number {
	font-size: 18px;
	font-weight: bold;
	color: var(--color-fg);
}

.stat-label {
	font-size: 11px;
	color: var(--color-fg-contrast-7-5);
	text-transform: uppercase;
}

.user-info {
	margin-bottom: 30px;
	padding: 15px;
	background: var(--color-bg-50);
	border-radius: 4px;
}

.user-about h3, .user-links h3 {
	margin: 0 0 10px 0;
	color: var(--color-fg-contrast-10);
	font-size: 14px;
	text-transform: uppercase;
}

.about-content {
	color: var(--color-fg);
	line-height: 1.4;
}

.user-links ul {
	list-style: none;
	padding: 0;
	margin: 0;
}

.user-links li {
	margin-bottom: 5px;
}

.user-links a {
	color: var(--color-fg-link);
	text-decoration: none;
}

.user-links a:hover {
	color: var(--color-fg-link-hover);
}

.activity-tabs {
	display: flex;
	border-bottom: 1px solid var(--color-fg-contrast-4-5);
	margin-bottom: 20px;
}

.activity-tabs .tab {
	padding: 10px 20px;
	color: var(--color-fg-contrast-7-5);
	text-decoration: none;
	border-bottom: 2px solid transparent;
	transition: all 0.2s ease;
}

.activity-tabs .tab:hover {
	color: var(--color-fg-link);
}

.activity-tabs .tab.active {
	color: var(--color-fg-link);
	border-bottom-color: var(--color-fg-link);
}

.no-content {
	color: var(--color-fg-contrast-7-5);
	font-style: italic;
	text-align: center;
	padding: 40px 20px;
}

.stories-list, .comments-list {
	space: 15px;
}

.story-item, .comment-item {
	display: flex;
	align-items: flex-start;
	margin-bottom: 15px;
	padding-bottom: 15px;
	border-bottom: 1px solid var(--color-fg-contrast-4-5);
}

.story-score, .comment-score {
	min-width: 40px;
	text-align: center;
	font-weight: bold;
	color: var(--color-fg-contrast-7-5);
	margin-right: 15px;
	padding-top: 2px;
}

.story-content, .comment-content {
	flex: 1;
}

.story-title {
	margin: 0 0 5px 0;
	font-size: 14px;
	line-height: 1.3;
}

.story-title a {
	color: var(--color-fg-link);
	text-decoration: none;
}

.story-title a:hover {
	color: var(--color-fg-link-hover);
}

.story-domain {
	color: var(--color-fg-contrast-7-5);
	font-size: 12px;
	margin-left: 5px;
}

.story-meta, .comment-meta {
	font-size: 11px;
	color: var(--color-fg-contrast-7-5);
}

.story-meta a, .comment-meta a {
	color: var(--color-fg-contrast-7-5);
	text-decoration: none;
}

.story-meta a:hover, .comment-meta a:hover {
	color: var(--color-fg-link);
}

.comment-story {
	font-size: 12px;
	color: var(--color-fg-contrast-7-5);
	margin-bottom: 8px;
}

.comment-story a {
	color: var(--color-fg-link);
	text-decoration: none;
}

.comment-text {
	color: var(--color-fg);
	line-height: 1.4;
	margin-bottom: 8px;
}

/* Settings Page */
.settings-page {
	max-width: 600px;
	margin: 0 auto;
	padding: 20px;
}

.settings-form {
	background: var(--color-bg);
	border: 1px solid var(--color-fg-contrast-4-5);
	border-radius: 4px;
	padding: 20px;
}

.settings-section {
	margin-bottom: 30px;
	padding-bottom: 20px;
	border-bottom: 1px solid var(--color-fg-contrast-4-5);
}

.settings-section:last-child {
	border-bottom: none;
}

.settings-section h2 {
	color: var(--color-fg);
	margin: 0 0 15px 0;
	font-size: 16px;
}

.form-group {
	margin-bottom: 15px;
}

.form-group label {
	display: block;
	margin-bottom: 5px;
	color: var(--color-fg-contrast-10);
	font-weight: bold;
}

.form-group.checkbox label {
	display: flex;
	align-items: center;
	font-weight: normal;
}

.form-group.checkbox input[type="checkbox"] {
	margin-right: 8px;
}

.form-group input[type="text"],
.form-group input[type="url"],
.form-group textarea {
	width: 100%;
	padding: 8px;
	border: 1px solid var(--color-fg-contrast-4-5);
	border-radius: 3px;
	background: var(--color-bg);
	color: var(--color-fg);
	font-family: inherit;
}

.form-group small {
	display: block;
	margin-top: 5px;
	color: var(--color-fg-contrast-7-5);
	font-size: 11px;
}

.form-actions {
	margin-top: 20px;
	padding-top: 20px;
	border-top: 1px solid var(--color-fg-contrast-4-5);
}

.submit-button {
	background: var(--color-fg-link);
	color: white;
	border: none;
	padding: 10px 20px;
	border-radius: 3px;
	cursor: pointer;
	margin-right: 10px;
}

.submit-button:hover {
	background: var(--color-fg-link-hover);
}

.cancel-link {
	color: var(--color-fg-contrast-7-5);
	text-decoration: none;
	padding: 10px 20px;
}

.cancel-link:hover {
	color: var(--color-fg-link);
}

.user-not-found {
	text-align: center;
	padding: 60px 20px;
}

.user-not-found h1 {
	color: var(--color-fg);
	margin-bottom: 10px;
}

.user-not-found p {
	color: var(--color-fg-contrast-7-5);
	margin-bottom: 20px;
}

.user-not-found a {
	color: var(--color-fg-link);
	text-decoration: none;
}

/* Enhanced Tagging Interface */
.tags-group {
	position: relative;
}

.suggested-tags {
	margin-bottom: 10px;
	padding: 10px;
	background: var(--color-bg-50);
	border-radius: 4px;
	border: 1px solid var(--color-fg-contrast-4-5);
}

.suggestion-label {
	font-size: 11px;
	color: var(--color-fg-contrast-7-5);
	text-transform: uppercase;
	margin-right: 8px;
}

.tag-suggestion, .popular-tag {
	background: var(--color-fg-link);
	color: white;
	border: none;
	padding: 3px 8px;
	border-radius: 12px;
	font-size: 11px;
	margin-right: 5px;
	margin-bottom: 3px;
	cursor: pointer;
	transition: background 0.2s ease;
}

.tag-suggestion:hover, .popular-tag:hover {
	background: var(--color-fg-link-hover);
}

.tag-suggestion.auto-suggested {
	background: var(--color-accent);
}

.tags-input-container {
	border: 1px solid var(--color-fg-contrast-4-5);
	border-radius: 4px;
	padding: 8px;
	background: var(--color-bg);
	display: flex;
	flex-wrap: wrap;
	align-items: center;
	gap: 5px;
	min-height: 40px;
}

.selected-tag {
	background: var(--color-fg-contrast-4-5);
	color: var(--color-fg);
	padding: 4px 8px;
	border-radius: 12px;
	font-size: 12px;
	display: inline-flex;
	align-items: center;
	gap: 5px;
}

.remove-tag {
	background: none;
	border: none;
	color: var(--color-fg-contrast-7-5);
	cursor: pointer;
	font-size: 14px;
	font-weight: bold;
	padding: 0;
	width: 16px;
	height: 16px;
	border-radius: 50%;
	display: flex;
	align-items: center;
	justify-content: center;
}

.remove-tag:hover {
	background: var(--color-fg-contrast-7-5);
	color: var(--color-bg);
}

#tag-input {
	border: none;
	outline: none;
	background: none;
	color: var(--color-fg);
	flex: 1;
	min-width: 150px;
	font-size: 14px;
}

.tag-autocomplete {
	position: absolute;
	top: 100%;
	left: 0;
	right: 0;
	background: var(--color-bg);
	border: 1px solid var(--color-fg-contrast-4-5);
	border-top: none;
	border-radius: 0 0 4px 4px;
	max-height: 200px;
	overflow-y: auto;
	z-index: 1000;
	box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}

.autocomplete-item {
	padding: 8px 12px;
	cursor: pointer;
	border-bottom: 1px solid var(--color-fg-contrast-4-5);
	display: flex;
	align-items: center;
	gap: 8px;
}

.autocomplete-item:last-child {
	border-bottom: none;
}

.autocomplete-item:hover {
	background: var(--color-fg-contrast-4-5);
}

.autocomplete-item.create-tag {
	color: var(--color-fg-link);
	font-style: italic;
}

.tag-description {
	color: var(--color-fg-contrast-7-5);
	font-size: 11px;
	flex: 1;
}

.tag-count {
	color: var(--color-fg-contrast-7-5);
	font-size: 10px;
	background: var(--color-fg-contrast-4-5);
	padding: 1px 4px;
	border-radius: 8px;
}

.popular-tags {
	margin-top: 10px;
}

.popular-tags summary {
	cursor: pointer;
	color: var(--color-fg-contrast-7-5);
	font-size: 11px;
	text-transform: uppercase;
	margin-bottom: 8px;
}

.popular-tags[open] summary {
	color: var(--color-fg-link);
}

.popular-tags-list {
	display: flex;
	flex-wrap: wrap;
	gap: 5px;
	padding: 10px;
	background: var(--color-bg-50);
	border-radius: 4px;
	border: 1px solid var(--color-fg-contrast-4-5);
}

.popular-tag {
	background: var(--color-fg-contrast-4-5);
	color: var(--color-fg);
	border: none;
	padding: 4px 8px;
	border-radius: 12px;
	font-size: 11px;
	cursor: pointer;
	transition: background 0.2s ease;
	display: inline-flex;
	align-items: center;
	gap: 3px;
}

.popular-tag:hover {
	background: var(--color-fg-link);
	color: white;
}

.popular-tag .tag-count {
	background: var(--color-fg-contrast-7-5);
	color: var(--color-bg);
}

.popular-tag:hover .tag-count {
	background: rgba(255,255,255,0.3);
	color: white;
}

/* Enhanced Tag Browsing Styles */

/* Tags Index Page */
.tags-page .page-header {
	margin-bottom: 2rem;
}

.tags-page .page-header h1 {
	color: var(--color-fg-contrast-1);
	margin-bottom: 0.5rem;
}

.tags-page .page-header p {
	color: var(--color-fg-contrast-6);
	font-size: 0.95rem;
}

.tags-controls {
	display: flex;
	justify-content: space-between;
	align-items: center;
	margin-bottom: 2rem;
	padding: 1rem;
	background: var(--color-bg-alt);
	border-radius: 6px;
	border: 1px solid var(--color-fg-contrast-7-5);
}

@media (max-width: 768px) {
	.tags-controls {
		flex-direction: column;
		gap: 1rem;
		align-items: stretch;
	}
}

.tag-search-form .search-group {
	display: flex;
	gap: 0.5rem;
	align-items: center;
}

.tag-search-input {
	padding: 0.5rem;
	border: 1px solid var(--color-fg-contrast-6);
	border-radius: 4px;
	font-size: 0.9rem;
	width: 250px;
}

.search-btn {
	padding: 0.5rem 1rem;
	background: var(--color-fg-link);
	color: white;
	border: none;
	border-radius: 4px;
	cursor: pointer;
	font-size: 0.9rem;
}

.search-btn:hover {
	background: var(--color-fg-link-hover);
}

.clear-search {
	color: var(--color-fg-contrast-4);
	text-decoration: none;
	font-size: 0.85rem;
}

.clear-search:hover {
	color: var(--color-fg-link);
}

.sort-controls {
	display: flex;
	align-items: center;
	gap: 0.5rem;
}

.sort-controls label {
	font-size: 0.9rem;
	color: var(--color-fg-contrast-3);
}

.sort-controls select {
	padding: 0.4rem;
	border: 1px solid var(--color-fg-contrast-6);
	border-radius: 4px;
	background: var(--color-bg);
	color: var(--color-fg);
	font-size: 0.9rem;
}

/* Trending Tags Section */
.trending-tags {
	margin-bottom: 2rem;
}

.trending-tags h2 {
	color: var(--color-fg-contrast-2);
	margin-bottom: 1rem;
	display: flex;
	align-items: center;
	gap: 0.5rem;
}

.trending-tags h2::before {
	content: "🔥";
	font-size: 1.2em;
}

.trending-tags-grid {
	display: grid;
	grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
	gap: 0.75rem;
}

.trending-tag {
	display: flex;
	justify-content: space-between;
	align-items: center;
	padding: 0.75rem;
	background: linear-gradient(135deg, var(--color-bg-alt) 0%, var(--color-bg-50) 100%);
	border: 1px solid var(--color-fg-contrast-7);
	border-radius: 8px;
	text-decoration: none;
	color: var(--color-fg);
	transition: all 0.2s ease;
	position: relative;
	overflow: hidden;
}

.trending-tag::before {
	content: '';
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	height: 2px;
	background: linear-gradient(90deg, #ff4444, #ff8800, #ffdd00);
	opacity: 0.8;
}

.trending-tag:hover {
	transform: translateY(-1px);
	box-shadow: 0 4px 12px rgba(0,0,0,0.1);
	border-color: var(--color-fg-link);
}

.trending-tag .tag-name {
	font-weight: 600;
	color: var(--color-fg-contrast-1);
}

.trending-count {
	background: var(--color-fg-link);
	color: white;
	padding: 0.2rem 0.5rem;
	border-radius: 12px;
	font-size: 0.8rem;
	font-weight: 500;
}

/* Tag Categories Section */
.tag-categories {
	margin-bottom: 2rem;
}

.tag-categories h2 {
	color: var(--color-fg-contrast-2);
	margin-bottom: 1rem;
}

.categories-grid {
	display: grid;
	grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
	gap: 1rem;
}

.category-card {
	padding: 1.25rem;
	background: var(--color-bg-alt);
	border: 1px solid var(--color-fg-contrast-7);
	border-radius: 8px;
	transition: border-color 0.2s ease;
}

.category-card:hover {
	border-color: var(--color-fg-contrast-5);
}

.category-card h3 {
	color: var(--color-fg-contrast-1);
	margin-bottom: 0.5rem;
	font-size: 1.1rem;
}

.category-card p {
	color: var(--color-fg-contrast-5);
	font-size: 0.9rem;
	margin-bottom: 1rem;
}

.category-tags {
	display: flex;
	flex-wrap: wrap;
	gap: 0.4rem;
}

.category-tag {
	background: var(--color-fg-contrast-7-5);
	color: var(--color-fg-contrast-3);
	padding: 0.3rem 0.6rem;
	border-radius: 12px;
	text-decoration: none;
	font-size: 0.8rem;
	transition: all 0.2s ease;
}

.category-tag:hover {
	background: var(--color-fg-link);
	color: white;
}

/* All Tags Grid */
.tags-grid {
	display: grid;
	grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
	gap: 1rem;
}

.tag-card {
	padding: 1rem;
	background: var(--color-bg-alt);
	border: 1px solid var(--color-fg-contrast-7-5);
	border-radius: 8px;
	transition: all 0.2s ease;
}

.tag-card:hover {
	border-color: var(--color-fg-contrast-5);
	box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.tag-header {
	display: flex;
	align-items: center;
	gap: 0.5rem;
	margin-bottom: 0.5rem;
}

.tag-card h3 {
	margin: 0;
	font-size: 1.1rem;
}

.tag-link {
	color: var(--color-fg-link);
	text-decoration: none;
}

.tag-link:hover {
	color: var(--color-fg-link-hover);
}

.privileged-badge,
.media-badge {
	font-size: 0.8rem;
	opacity: 0.8;
}

.privileged-badge {
	color: #ffc107;
	title: "Privileged tag";
}

.media-badge {
	color: #6f42c1;
}

.tag-description {
	color: var(--color-fg-contrast-5);
	font-size: 0.9rem;
	margin: 0.5rem 0;
	line-height: 1.4;
}

.tag-stats {
	display: flex;
	align-items: center;
	gap: 0.75rem;
	color: var(--color-fg-contrast-6);
	font-size: 0.85rem;
}

.story-count {
	display: flex;
	align-items: center;
	gap: 0.25rem;
}

.story-count strong {
	color: var(--color-fg-contrast-3);
}

.hotness-mod {
	font-size: 0.9rem;
}

/* No Results States */
.no-results,
.no-tags {
	text-align: center;
	padding: 2rem;
	color: var(--color-fg-contrast-5);
}

/* Individual Tag Page Styles (Lobste.rs style) */
.tag-page .stories h1 {
	color: var(--color-fg-contrast-1);
	margin-bottom: 0.5rem;
	font-size: 2rem;
}

.tag-page .tag-description {
	color: var(--color-fg-contrast-4);
	font-size: 0.95rem;
	margin-bottom: 0.5rem;
}

.tag-page .related-tags-text {
	color: var(--color-fg-contrast-4);
	font-size: 0.9rem;
	margin-bottom: 1.5rem;
	line-height: 1.4;
}

.tag-page .related-tags-text a {
	color: var(--color-fg-link);
	text-decoration: none;
}

.tag-page .related-tags-text a:hover {
	color: var(--color-fg-link-hover);
}

/* Simplified tag page - removed complex statistics styling */

/* No Stories State */
.no-stories {
	text-align: center;
	padding: 3rem 1rem;
	color: var(--color-fg-contrast-5);
}

.no-stories p {
	margin-bottom: 0.5rem;
}

/* Tag Navigation */
.tag-navigation {
	display: flex;
	justify-content: space-between;
	align-items: center;
	margin-top: 2rem;
	padding-top: 1rem;
	border-top: 1px solid var(--color-fg-contrast-7-5);
}

.back-link,
.rss-link {
	color: var(--color-fg-link);
	text-decoration: none;
	font-size: 0.9rem;
}

.back-link:hover,
.rss-link:hover {
	color: var(--color-fg-link-hover);
}

.rss-link::after {
	content: " 📡";
	font-size: 0.8rem;
}

/* Current tag highlighting */
.story-tags .tag.current-tag {
	background: var(--color-fg-link);
	color: white;
}

/* Inline Story Tags (Lobste.rs style) */
.story-title .story-tags {
	display: inline;
	margin-left: 0.5em;
}

.story-title .story-tags .tag {
	display: inline-block;
	background: var(--color-tag-bg);
	border: 1px solid var(--color-tag-border);
	border-radius: 3px;
	padding: 0.1em 0.3em;
	margin: 0 0.2em;
	font-size: 0.75em;
	font-weight: normal;
	text-decoration: none;
	color: var(--color-fg-contrast-4);
	vertical-align: baseline;
	line-height: 1;
}

/* Different sizes for different heading levels */
h1.story-title .story-tags .tag {
	font-size: 0.6em;
}

h2.story-title .story-tags .tag,
.story-title h2 .story-tags .tag {
	font-size: 0.7em;
}

h3.story-title .story-tags .tag {
	font-size: 0.75em;
}

.story-title .story-tags .tag:hover {
	background: var(--color-tag-border);
	color: var(--color-fg-contrast-2);
	text-decoration: none;
}

.story-title .story-tags .tag:visited {
	color: var(--color-fg-contrast-4);
}

/* Special tag styles */
.story-title .story-tags .tag[href*="/t/meta"],
.story-title .story-tags .tag[href*="/t/announce"] {
	background: var(--color-tag-meta-bg);
	border-color: var(--color-tag-meta-border);
	color: var(--color-fg-contrast-10);
}

.story-title .story-tags .tag[href*="/t/video"],
.story-title .story-tags .tag[href*="/t/audio"],
.story-title .story-tags .tag[href*="/t/slides"] {
	background: var(--color-tag-media-bg);
	border-color: var(--color-tag-media-border);
	color: var(--color-fg-contrast-10);
}

/* Ensure tags don't wrap awkwardly */
.story-title h2 {
	line-height: 1.3;
}

/* Responsive adjustments for inline tags */
@media (max-width: 768px) {
	.story-title .story-tags {
		display: block;
		margin-left: 0;
		margin-top: 0.3em;
	}
	
	.story-title .story-tags .tag {
		margin: 0.1em 0.2em 0.1em 0;
	}
}

/* Responsive adjustments */
@media (max-width: 768px) {
	.trending-tags-grid {
		grid-template-columns: 1fr;
	}
	
	.categories-grid {
		grid-template-columns: 1fr;
	}
	
	.tags-grid {
		grid-template-columns: 1fr;
	}
	
	.stats-grid {
		grid-template-columns: repeat(2, 1fr);
	}
	
	.tag-navigation {
		flex-direction: column;
		gap: 0.75rem;
		text-align: center;
	}
}

/* User Settings Tag Preferences */
.settings-section {
	margin-bottom: 2rem;
	padding-bottom: 1.5rem;
	border-bottom: 1px solid var(--color-fg-contrast-8);
}

.settings-section:last-of-type {
	border-bottom: none;
}

.settings-section h3 {
	color: var(--color-fg-contrast-2);
	margin-bottom: 0.75rem;
	font-size: 1.1rem;
}

.section-description {
	color: var(--color-fg-contrast-5);
	font-size: 0.9rem;
	margin-bottom: 1rem;
}

.tag-input-container {
	position: relative;
}

.tag-input {
	width: 100%;
	padding: 0.75rem;
	border: 1px solid var(--color-fg-contrast-6);
	border-radius: 4px;
	font-size: 0.9rem;
	font-family: inherit;
	background: var(--color-bg);
	color: var(--color-fg);
}

.tag-input:focus {
	outline: none;
	border-color: var(--color-fg-link);
	box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
}

.tag-suggestions {
	margin-top: 1rem;
}

.tag-suggestions summary {
	cursor: pointer;
	color: var(--color-fg-contrast-4);
	font-size: 0.9rem;
	padding: 0.5rem 0;
	border-radius: 4px;
}

.tag-suggestions summary:hover {
	color: var(--color-fg-link);
}

.available-tags-grid {
	display: grid;
	grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
	gap: 0.5rem;
	padding: 1rem;
	background: var(--color-bg-alt);
	border: 1px solid var(--color-fg-contrast-7-5);
	border-radius: 6px;
	margin-top: 0.5rem;
	max-height: 300px;
	overflow-y: auto;
}

.available-tag {
	background: var(--color-fg-contrast-8);
	color: var(--color-fg-contrast-3);
	border: 1px solid var(--color-fg-contrast-7);
	padding: 0.5rem 0.75rem;
	border-radius: 6px;
	font-size: 0.85rem;
	cursor: pointer;
	transition: all 0.2s ease;
	text-align: center;
	display: flex;
	flex-direction: column;
	align-items: center;
	gap: 0.25rem;
}

.available-tag:hover {
	background: var(--color-fg-contrast-6);
	color: var(--color-fg-contrast-2);
	border-color: var(--color-fg-contrast-5);
}

.available-tag.filtered {
	background: #ffebee;
	color: #d32f2f;
	border-color: #f8bbd9;
}

.available-tag.filtered:hover {
	background: #ffcdd2;
	border-color: #e57373;
}

.available-tag.favorite {
	background: #e8f5e8;
	color: #2e7d32;
	border-color: #c8e6c9;
}

.available-tag.favorite:hover {
	background: #dcedc8;
	border-color: #9ccc65;
}

.available-tag .tag-count {
	background: var(--color-fg-contrast-7);
	color: var(--color-fg-contrast-4);
	padding: 0.15rem 0.4rem;
	border-radius: 8px;
	font-size: 0.75rem;
	font-weight: 500;
}

.available-tag.filtered .tag-count {
	background: #ffab91;
	color: #bf360c;
}

.available-tag.favorite .tag-count {
	background: #a5d6a7;
	color: #1b5e20;
}

/* Dark theme adjustments */
@media (prefers-color-scheme: dark) {
	.available-tag.filtered {
		background: #3e2723;
		color: #ff8a80;
		border-color: #5d4037;
	}
	
	.available-tag.filtered:hover {
		background: #4e342e;
		border-color: #6d4c41;
	}
	
	.available-tag.favorite {
		background: #1b5e20;
		color: #81c784;
		border-color: #2e7d32;
	}
	
	.available-tag.favorite:hover {
		background: #2e7d32;
		border-color: #388e3c;
	}
}

/* Responsive adjustments for tag preferences */
@media (max-width: 768px) {
	.available-tags-grid {
		grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
		gap: 0.4rem;
	}
	
	.available-tag {
		padding: 0.4rem 0.6rem;
		font-size: 0.8rem;
	}
}

/* Unread Message Badge */
.unread-badge {
	background-color: var(--color-accent);
	color: white;
	font-size: 9px;
	font-weight: bold;
	padding: 2px 6px;
	border-radius: 10px;
	margin-left: 4px;
	position: relative;
	top: -1px;
	display: inline-block;
	min-width: 16px;
	text-align: center;
	line-height: 1.2;
	animation: pulse 2s infinite;
}

@keyframes pulse {
	0% {
		opacity: 1;
	}
	50% {
		opacity: 0.7;
	}
	100% {
		opacity: 1;
	}
}
